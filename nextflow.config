manifest {
	homePage = 'https://github.com/EpiRnaTools/ribomethseq-nf'
	description = 'RiboMethSeq data processing'
	mainScript = 'main.nf'
	name = 'ribomethseq-nf'
	author = 'Hermes Paraqindes & Theo Combe'
}

/***************************************************************/
/*                  Nextflow execution reporting               */
/***************************************************************/
params.outdir      = '.'
params.logdir      = params.outdir
params.report_dir  = params.logdir
params.report_base = 'ribomethseq-nf.report'

report {
	enabled = true
	file = "${params.report_dir}/${params.report_base}/report.html"
}

timeline {
	enabled = true
	file = "${params.report_dir}/${params.report_base}/timeline.html"
}

dag {
	enabled = true
	file = "${params.report_dir}/${params.report_base}/dag.png"
}

trace {
	enabled = true
	fields = 'process,task_id,hash,name,attempt,status,exit,realtime,cpus,memory,%cpu,vmem,rss,submit,start,complete,duration,realtime,rchar,wchar'
	file = "${params.report_dir}/${params.report_base}/trace.txt"
}

/***************************************************************/
/*                  Nextflow execution parameters              */
/***************************************************************/
params.qsize            = 1
params.fastqc_threads   = 2
params.trimmo_threads   = 3
params.bowtie_threads   = 7
params.samtools_threads = 4

process {
	withName: 'fastqc_before'  {cpus = params.fastqc_threads; time = '1h'}
	withName: 'trim'           {cpus = params.trimmo_threads; time = '4h'}
	withName: 'fastqc_after'   {cpus = params.fastqc_threads; time = '1h'}
	withName: 'multiqc'        {cpus = 2; time = '1h'}
	withName: 'bowtie2'        {cpus = params.bowtie_threads; memory = 12.GB; time = '12h'}
	withName: 'r_refine'       {cpus = 4; memory = 4.GB}
	withName: 'count5'         {cpus = params.samtools_threads; memory = 12.GB}
	withName: 'r_export'       {cpus = 2; time = '1h'}
}

profiles {
	conda {
		process.conda = "$baseDir/conda.yml"
		conda.enabled = true
	}
	docker {
		docker.enabled = true
	}
	human {
		params {
			bowtie_index =  "$baseDir/data/bowtie/human/human_index"
			size58S = 157
			size28S = 5070
			size18S = 1869
			size5S = 121
			fasta_58S =  "$baseDir/fasta/Human_58SrRNA_NR_046235_3.fasta"
			fasta_18S =  "$baseDir/fasta/Human_18SrRNA_NR_046235_3.fasta"
			fasta_28S =  "$baseDir/fasta/Human_28SrRNA_NR_046235_3.fasta"
			fasta_5S =   "$baseDir/fasta/Human_5SrRNA_NR_046235_3.fasta"
			search_58S = "NR_046235.3_5.8S"
			search_18S = "NR_046235.3_18S"
			search_28S = "NR_046235.3_28S"
			search_5S = "NR_023363.1_5S"
		}
	}
	mouse {
		params {
			bowtie_index = "$baseDir/data/bowtie/mouse/mouse_index"
			size58S = 157
			size28S = 4730
			size18S = 1870
			size5S = 121
			fasta_58S =  "$baseDir/fasta/Mouse_58SrRNA_NR_003280_2.fasta"
			fasta_18S =  "$baseDir/fasta/Mouse_18SrRNA_NR_003278_3.fasta"
			fasta_28S =  "$baseDir/fasta/Mouse_28SrRNA_NR_003279_1.fasta"
			fasta_5S =   "$baseDir/fasta/Mouse_5SrRNA_NR_030686_1.fasta"
			search_58S = "NR_003280.2_5.8SrRNA_mouse"
			search_18S = "NR_003278.3_18SrRNA_mouse"
			search_28S = "NR_003279.1_28SrRNA_mouse"
			search_5S = "NR_030686.1_5SrRNA_mouse"
		}
	}
}
